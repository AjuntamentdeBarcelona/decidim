<% detail = action_name == "show" %>

<div id="order-progress">
  <%= render partial: "decidim/budgets/budget_summary/voting_rules" %>

  <div class="card budget-summary" data-progress-reference data-safe-url="<%= budget_url(budget) %>">
    <div class="card__content">
      <%= render partial: "decidim/budgets/budget_summary/information" %>
      <%= render partial: "decidim/budgets/budget_summary/total" %>

      <div class="budget-summary__progressbox budget-summary__progress--bar" data-current-allocation="<%= current_order ? current_order.total : 0 %>">
        <div class="progress budget-progress" role="progressbar" aria-valuenow="<%= current_order_budget_percent %>" aria-valuetext="<%= current_order_budget_percent %>%" aria-valuemin="0" aria-valuemax="100">
          <div class="progress-meter progress-meter--minimum" style="width: <%= current_order_budget_percent_minimum %>%"></div>
          <!--Change width and text dynamically.-->
          <div class="progress-meter budget-progress__meter" style="width: <%= current_order_budget_percent %>%">
            <span class="progress-meter-text progress-meter-text--right">
              <%= render partial: "decidim/budgets/projects/order_total_budget" %>
            </span>
          </div>
        </div>
        <% if !current_order_checked_out? && voting_open? %>
          <button class="button small button--sc" data-toggle="budget-confirm" <%= budget_confirm_disabled_attr %>>
            <%= t(".vote") %>
          </button>
        <% end %>
      </div>

      <%= cell("decidim/budgets/budget_information_modal", budget) %>
    </div>

    <%= render partial: "decidim/budgets/projects/order_selected_projects" %>
  </div>

  <%= render partial: "decidim/budgets/projects/budget_excess" %>
  <%= render partial: "decidim/budgets/projects/budget_confirm" %>
</div>
